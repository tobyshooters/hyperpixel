<style>
img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border: 1px solid black;
    margin-bottom: 11px;
}
</style>

<div id="home" style="display: flex; flex-direction: column">
    <div style="display: flex; align-items: center">
        <p style="margin-right: 11px">{{user}} {{imageId}}</p>
        <input id="input" type="file" accept="image/*"></input>
    </div>
</div>

<script>
    // Extract out Jinja variables
    const user = "{{user}}";
    const imageId = "{{imageId}}"

    const output = document.createElement("img");
    output.onload = () => {
        document.getElementById("home").appendChild(output);
    }
    output.src = `/static/${user}_${imageId}.jpg`;

    // Allow uploading the image
    const input = document.getElementById("input");
    input.onchange = e => {

        // Immediately show image on front-end
        const fr = new FileReader();
        fr.onload = () => output.src = fr.result;
        fr.readAsDataURL(e.target.files[0]);

        // Persist to back-end so shows up on reload
        const data = new FormData();
        data.append('file', e.target.files[0]);
        fetch(`/${user}/${imageId}`, {
            method: "POST",
            body: data,
        })
    }
</script>

